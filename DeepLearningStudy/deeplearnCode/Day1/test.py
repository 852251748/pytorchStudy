import torch

a = torch.tensor([[1.2210e-05, 9.2148e-07, 6.5073e-03, 6.3681e-04, 3.6374e-06, 2.8661e-06,
                   1.1321e-07, 9.9077e-01, 3.8402e-04, 1.6789e-03],
                  [8.2596e-07, 7.1714e-09, 4.3755e-04, 5.8486e-09, 2.9170e-06, 2.5290e-06,
                   9.9955e-01, 1.8296e-10, 8.3474e-06, 9.0991e-08],
                  [1.9341e-06, 7.2403e-09, 3.9260e-04, 3.8845e-09, 5.4636e-06, 1.5290e-05,
                   9.9958e-01, 7.0810e-10, 2.3901e-06, 7.3925e-07]])
b = torch.tensor([[0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
                  [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
                  [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.]])

mask = (torch.argmax(a, dim=1) == torch.argmax(b, dim=1)).sum().float()
print(mask)
print(mask.sum().float() / a.shape[0])
